from telethon import TelegramClient, events
import asyncio
import random
import platform
import json
import torch
from transformers import GPT2LMHeadModel, GPT2Tokenizer, Trainer, TrainingArguments, DataCollatorForLanguageModeling
from datasets import Dataset
import os
from datetime import datetime, timedelta

class DataCollector:
    """–°–±–æ—Ä—â–∏–∫ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫–∞–Ω–∞–ª–∞"""
    def __init__(self):
        self.posts_data = []

    async def collect_posts(self, client, channel_username, limit=10000):
        """–°–æ–±–∏—Ä–∞–µ–º –ø–æ—Å—Ç—ã –∏–∑ –∫–∞–Ω–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É—è –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç"""
        print(f"üìä –°–æ–±–∏—Ä–∞—é –ø–æ—Å—Ç—ã –∏–∑: {channel_username}")

        channel = await client.get_entity(channel_username)
        print(f"üìä –ù–∞–π–¥–µ–Ω –∫–∞–Ω–∞–ª: {channel.title}")

        # –°–æ–±–∏—Ä–∞–µ–º –ø–æ—Å—Ç—ã
        posts = []
        total_collected = 0

        try:
            # –ü—Ä–æ–±—É–µ–º —Å–æ–±—Ä–∞—Ç—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 180 –¥–Ω–µ–π
            since_date = datetime.now() - timedelta(days=730)
            async for message in client.iter_messages(
                    channel,
                    limit=limit,
                    offset_date=since_date
            ):
                if message.text and len(message.text.strip()) > 5:  # –£–º–µ–Ω—å—à–∏–ª –¥–æ 5 —Å–∏–º–≤–æ–ª–æ–≤
                    posts.append(message.text)
                    total_collected += 1
                    if total_collected % 50 == 0:
                        print(f"üìù –°–æ–±—Ä–∞–Ω–æ {total_collected} –ø–æ—Å—Ç–æ–≤...")

        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–µ —Å –¥–∞—Ç–æ–π: {e}")
            # –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Å –¥–∞—Ç–æ–π, —Å–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ—Å—Ç–æ –ø–æ –ª–∏–º–∏—Ç—É
            async for message in client.iter_messages(channel, limit=limit):
                if message.text and len(message.text.strip()) > 5:
                    posts.append(message.text)
                    total_collected += 1
                    if total_collected % 50 == 0:
                        print(f"üìù –°–æ–±—Ä–∞–Ω–æ {total_collected} –ø–æ—Å—Ç–æ–≤...")

        print(f"‚úÖ –í—Å–µ–≥–æ —Å–æ–±—Ä–∞–Ω–æ {len(posts)} –ø–æ—Å—Ç–æ–≤")
        return posts

class ResponseGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è"""
    def generate_responses(self, posts):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫—Ä—É—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –ø–æ—Å—Ç—ã"""
        responses = []

        for i, post in enumerate(posts):
            post_lower = post.lower()

            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Å—Ç–∏–ª–µ –∫—Ä–∞—Ñ—Ç–æ–≤–æ–π –∫—É–ª—å—Ç—É—Ä—ã —Å —é–º–æ—Ä–æ–º
            if any(word in post_lower for word in ['–ø–∏–≤–æ', 'beer', '–ø–µ–Ω–Ω—ã–π', '–ª–∞–≥–µ—Ä', '—ç–ª—å', '—Å—Ç–∞—É—Ç', 'ipa', 'apa', '–∫—Ä–∞—Ñ—Ç']):
                response = random.choice([
                    "–û—Ç–ª–∏—á–Ω—ã–π –∫—Ä–∞—Ñ—Ç! –•–º–µ–ª—å –ø—Ä–æ—Å—Ç–æ –±–æ–º–±–∞! üç∫üî•",
                    "–ü–∏–≤–æ, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –º—É—Ä–∞—à–∫–∏ –ø–æ –∫–æ–∂–µ! üçª‚ú®",
                    "–¢–∞–∫–æ–π —ç–ª—å –º–æ–∂–Ω–æ –ø–∏—Ç—å –ª–∏—Ç—Ä–∞–º–∏! üòçüç∫",
                    "–ù–∞—Å—Ç–æ—è—â–∏–π –∫—Ä–∞—Ñ—Ç - —á—É–≤—Å—Ç–≤—É–µ—Ç—Å—è —Ä—É–∫–∞ –º–∞—Å—Ç–µ—Ä–∞! üë®üçª",
                    "–ü–∏–≤–æ, —Ä–∞–¥–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —Å—Ç–æ–∏—Ç –∂–∏—Ç—å! üç∫üí´",
                    "–•–º–µ–ª—å–Ω–∞—è —Ñ–µ–µ—Ä–∏—è! –ñ–¥—É –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è! üéâüçª",
                    "–≠—Ç–æ—Ç —Å—Ç–∞—É—Ç - –ø—Ä–æ—Å—Ç–æ –∫–æ—Å–º–æ—Å! üååüç∫",
                    "–≠—Ç–æ—Ç IPA –Ω–∞—Å—Ç–æ–ª—å–∫–æ –≥–æ—Ä—å–∫–∏–π, —á—Ç–æ –¥–∞–∂–µ –ø–∞—Ä–µ–Ω—å –æ–¥–æ–±—Ä–∏–ª! üòÇüç∫",
                    "–ì–æ–≤–æ—Ä—è—Ç, –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å—Ç–∞—É—Ç–∞ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –∑–≤—É–∫ –∏ —É—Å–ª—ã—à–∞—Ç—å —Ü–≤–µ—Ç. –ü—Ä–æ–≤–µ—Ä–∏–º? üåàüç∫",
                    "–ö—Ä–∞—Ñ—Ç, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ —É –±–æ—Ä–æ–¥—ã —Å–∞–º–æ–π –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞—Å—Ç–∏ —Ö–º–µ–ª—å! üßî‚Äç‚ôÄÔ∏èüç∫",
                    "–≠—Ç–æ –Ω–µ –ø–∏–≤–æ, —ç—Ç–æ —Ö–º–µ–ª—å–Ω–∞—è —Ç–µ—Ä–∞–ø–∏—è –æ—Ç –≤—Å–µ—Ö –∂–∏–∑–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º. üõÄüç∫",
                    "–¢–∞–∫–æ–µ –ø–∏–≤–æ, —á—Ç–æ –¥–∞–∂–µ –ª–æ—Å–æ—Å—å –±—ã –ø–æ—à—ë–ª –Ω–∞ –Ω–µ—Ä–µ—Å—Ç –≤ —Ç–≤–æ–π –±–æ–∫–∞–ª! üêüüç∫",
                    "–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–∏–≤–∞ –ø–æ–Ω–∏–º–∞–µ—à—å, —á—Ç–æ 'apa' - —ç—Ç–æ –Ω–µ –æ–ø–µ—á–∞—Ç–∫–∞, –∞ –∫—Ä–∏–∫ –¥—É—à–∏! üó£Ô∏èüç∫",
                    "–ü–µ–Ω–Ω—ã–π, –∫–∞–∫ –º–æ–∏ –º—ã—Å–ª–∏ –æ –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–º –¥–Ω–µ –ø–æ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞–º. üòµ"
                ])
            elif any(word in post_lower for word in ['–º–µ–¥', '–º—ë–¥', '–ø—á–µ–ª', '–ø—á—ë–ª—ã', '–º–µ–¥–æ–≤—É—Ö', '–º–∏–¥']):
                response = random.choice([
                    "–ú–µ–¥–æ–≤—É—Ö–∞ - –Ω–∞–ø–∏—Ç–æ–∫ –±–æ–≥–æ–≤! üçØüëë",
                    "–ù–∞—Å—Ç–æ—è—â–∏–π –º–∏–¥ - —Å–ª–∞—â–µ –ø–æ—Ü–µ–ª—É—è! üíãüçØ",
                    "–ü—á–µ–ª–∫–∏ –±—ã –æ–¥–æ–±—Ä–∏–ª–∏! üêù‚ù§Ô∏è",
                    "–ú–µ–¥, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –¥—É—à–∞ –ø–æ–µ—Ç! üéµüçØ",
                    "–ó–æ–ª–æ—Ç–æ–π –Ω–∞–ø–∏—Ç–æ–∫ –¥–ª—è –∑–æ–ª–æ—Ç—ã—Ö –ª—é–¥–µ–π! ‚ú®üçØ",
                    "–ú–µ–¥–æ–≤—É—Ö–∞, –∫–æ—Ç–æ—Ä–∞—è –≥—Ä–µ–µ—Ç –¥—É—à—É! üî•üçØ",
                    "–ù–∞—Å—Ç–æ—è—â–∞—è –º–µ–¥–æ–≤–∞—è –º–∞–≥–∏—è! üßôüçØ",
                    "–≠—Ç–∞ –º–µ–¥–æ–≤—É—Ö–∞ –Ω–∞—Å—Ç–æ–ª—å–∫–æ —Å–ª–∞–¥–∫–∞—è, —á—Ç–æ —É –∏–Ω—Å—É–ª–∏–Ω–∞ —Å–ª—é–Ω–∫–∏ –ø–æ—Ç–µ–∫–ª–∏! üçØüòÜ",
                    "–ü—á—ë–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ —Å–¥–µ–ª–∞–ª–∏, –Ω–∞–≤–µ—Ä–Ω–æ–µ, –ø–æ–ª—É—á–∏–ª–∏ –ù–æ–±–µ–ª–µ–≤—Å–∫—É—é –ø—Ä–µ–º–∏—é –ø–æ –≥–∞—Å—Ç—Ä–æ–Ω–æ–º–∏–∏. üêùüèÜ",
                    "–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º–∏–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—à—å –ø–æ–Ω–∏–º–∞—Ç—å —è–∑—ã–∫ –ø—á—ë–ª. –ñ-–∂-–∂-–∂–µ–ª–∞—é –µ—â—ë! üêùüó£Ô∏è",
                    "–ú—ë–¥, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –í–∏–Ω–Ω–∏-–ü—É—Ö –ø—Ä–æ–¥–∞–ª –±—ã –¥—É—à—É. –ò –µ—â—ë –ø–æ–ø—Ä–æ—Å–∏–ª –¥–æ–±–∞–≤–∫–∏. üêªüí∏",
                    "–≠—Ç–æ –Ω–µ –æ–ø—å—è–Ω–µ–Ω–∏–µ, —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ '–º–µ–¥–æ–≤–æ–≥–æ –±–ª–∞–∂–µ–Ω—Å—Ç–≤–∞'. –û—Å—Ç–æ—Ä–æ–∂–Ω–æ, –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–≤—ã–∫–∞–Ω–∏–µ! üçØüòµ",
                    "–ù–∞—Å—Ç–æ—è—â–∏–π –º–∏–¥ - –∫–æ–≥–¥–∞ –ø–æ–Ω–∏–º–∞–µ—à—å, —á—Ç–æ '–ø—á–µ–ª–∏–Ω—ã–π —Ç—Ä—É–¥' - —ç—Ç–æ –Ω–µ –º–µ—Ç–∞—Ñ–æ—Ä–∞! üêùüí™"
                ])
            elif any(word in post_lower for word in ['—Å–∏–¥—Ä', 'cider', '—è–±–ª–æ—á–Ω', '–≥—Ä—É—à']):
                response = random.choice([
                    "–°–∏–¥—Ä - –æ—Å–µ–Ω—å –≤ –±–æ–∫–∞–ª–µ! üçÇüçé",
                    "–Ø–±–ª–æ—á–Ω–∞—è —Å–≤–µ–∂–µ—Å—Ç—å - —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—É—á—à–µ! üçè‚ú®",
                    "–°–∏–¥—Ä, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ —â–µ–∫–∏ —Ä–æ–∑–æ–≤–µ—é—Ç! üçéüòä",
                    "–ù–∞—Å—Ç–æ—è—â–∏–π —è–±–ª–æ—á–Ω—ã–π –≤–æ—Å—Ç–æ—Ä–≥! üçéüéâ",
                    "–°–∏–¥—Ä –¥–ª—è –∏—Å—Ç–∏–Ω–Ω—ã—Ö —Ü–µ–Ω–∏—Ç–µ–ª–µ–π! üëåüçé",
                    "–ü–∞—Ö–Ω–µ—Ç —è–±–ª–æ–∫–∞–º–∏ –∏ —Å—á–∞—Å—Ç—å–µ–º! üçéüí´",
                    "–û—Å–≤–µ–∂–∞—é—â–∏–π –∫–∞–∫ —É—Ç—Ä–µ–Ω–Ω—è—è —Ä–æ—Å–∞! üåÖüçé",
                    "–≠—Ç–æ—Ç —Å–∏–¥—Ä –Ω–∞—Å—Ç–æ–ª—å–∫–æ —è–±–ª–æ—á–Ω—ã–π, —á—Ç–æ –ù—å—é—Ç–æ–Ω –ø–æ–¥ –Ω–∏–º –Ω–µ —Ç–æ–ª—å–∫–æ —è–±–ª–æ–∫–æ –ø–æ–π–º–∞–ª, –Ω–æ –∏ —Ç–µ–æ—Ä–∏—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–æ–ø–∏–ª! üçéüî≠",
                    "–°–∏–¥—Ä, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–∞–∂–µ –ì—Ä–µ–Ω–Ω–∏ –°–º–∏—Ç –ø–æ–∫—Ä–∞—Å–Ω–µ–ª–∞ –±—ã! üçèüò≥",
                    "–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–∏–¥—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—à—å –≤–∏–¥–µ—Ç—å core-–ø–ª–æ–¥—ã, –∞ –Ω–µ –æ–±—ã—á–Ω—ã–µ —è–±–ª–æ–∫–∏! üçéüíª",
                    "–û—Å–≤–µ–∂–∞—é—â–∏–π, –∫–∞–∫ –ø–æ—â–µ—á–∏–Ω–∞ —Å–Ω–µ–∂–Ω–æ–π –∫–æ—Ä–æ–ª–µ–≤—ã. –ù–æ –ø—Ä–∏—è—Ç–Ω–µ–µ! ‚ùÑÔ∏èüçé",
                    "–ì—Ä—É—à–µ–≤—ã–π —Å–∏–¥—Ä? –≠—Ç–æ –∫–æ–≥–¥–∞ —Ç—ã —Ç–∞–∫–æ–π —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π, —á—Ç–æ –¥–∞–∂–µ –ø—å—è–Ω–µ–µ—à—å —Å –∞–∫—Ü–µ–Ω—Ç–æ–º. üçêüé©"
                ])
            elif any(word in post_lower for word in ['–≤–∏–Ω–æ', '–≤–∏–Ω–æ–≥—Ä–∞–¥', '–≤–∏–Ω–Ω', '—à–∞–º–ø–∞–Ω—Å–∫', '–∏–≥—Ä–∏—Å—Ç–æ–µ']):
                response = random.choice([
                    "–í–∏–Ω–æ, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –∫—Ä—É–∂–∏—Ç—Å—è –≥–æ–ª–æ–≤–∞! üç∑üòµ",
                    "–ë—É–∫–µ—Ç –ø—Ä–æ—Å—Ç–æ –±–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π! üëÉüç∑",
                    "–í–∏–Ω–æ –¥–ª—è —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –≤–µ—á–µ—Ä–æ–≤! üåπüç∑",
                    "–ù–∞—Å—Ç–æ—è—â–∞—è –≤–∏–Ω–æ–≥—Ä–∞–¥–Ω–∞—è –ø–æ—ç–∑–∏—è! üìñüçá",
                    "–ò–≥—Ä–∏—Å—Ç–æ–µ, –∫–∞–∫ –Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –Ω–æ—á—å! üéÜü•Ç",
                    "–í–∏–Ω–æ, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é! üó£Ô∏èüç∑",
                    "–ë–æ–∫–∞–ª –≤–∏–Ω–∞ - –ª–µ–∫–∞—Ä—Å—Ç–≤–æ –æ—Ç –≤—Å–µ–≥–æ! üíäüç∑",
                    "–ë—É–∫–µ—Ç —É –≤–∏–Ω–∞ —Ç–∞–∫–æ–π —Å–ª–æ–∂–Ω—ã–π, —á—Ç–æ –¥–ª—è –µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –Ω—É–∂–Ω–æ –≤—ã—Å—à–µ–µ —Ñ–∏–ª–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ! üç∑üìö",
                    "–≠—Ç–æ –≤–∏–Ω–æ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –≤—ã–¥–µ—Ä–∂–∞–Ω–Ω–æ–µ, —á—Ç–æ –æ–Ω–æ –ø–æ–º–Ω–∏—Ç, –∫–∞–∫ –ù–∞–ø–æ–ª–µ–æ–Ω –±—ã–ª –µ—â—ë –ª–µ–π—Ç–µ–Ω–∞–Ω—Ç–æ–º! üç∑üë¥",
                    "–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —à–∞–º–ø–∞–Ω—Å–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–µ—à—å, —á—Ç–æ '–∏–≥—Ä–∏—Å—Ç–æ–µ' - —ç—Ç–æ –Ω–µ –ø—Ä–æ –≤–∏–Ω–æ, –∞ –ø—Ä–æ —Ç–≤–æ—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ! ü•Ç‚ú®",
                    "–í–∏–Ω–æ, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–∞–∂–µ —Å–æ–º–µ–ª—å–µ –∑–∞–ø–ª–∞–∫–∞–ª –∏ –ø–æ–∑–≤–æ–Ω–∏–ª –º–∞–º–µ. üç∑üò≠üìû",
                    "–¢–∞–Ω–Ω–∏–Ω—ã —Ç–∞–∫–∏–µ –±–∞—Ä—Ö–∞—Ç–Ω—ã–µ, —á—Ç–æ —Ö–æ—á–µ—Ç—Å—è –ø–æ—à–∏—Ç—å –∏–∑ –Ω–∏—Ö –ø–∏–¥–∂–∞–∫. üç∑üß•"
                ])
            elif any(word in post_lower for word in ['–∞–ª–∫–æ–≥–æ–ª', '–≤–∏—Å–∫–∏', '–≤–æ–¥–∫–∞', '–∫–æ–Ω—å—è–∫', '—Ä–æ–º', '–¥–∂–∏–Ω', '—Ç–µ–∫–∏–ª–∞']):
                response = random.choice([
                    "–ö—Ä–µ–ø–∫–∏–π –Ω–∞–ø–∏—Ç–æ–∫ –¥–ª—è —Å–∏–ª—å–Ω—ã—Ö –¥—É—Ö–æ–º! üí™ü•É",
                    "–ê–ª–∫–æ–≥–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –ª–µ—á–∏—Ç –¥—É—à—É! ‚ù§Ô∏èü©π",
                    "–ù–∞ —Ç–∞–∫–æ–º –∏ –≥–æ—Ä—ã —Å–≤–µ—Ä–Ω–µ—à—å! üèîÔ∏èü•É",
                    "–ù–∞–ø–∏—Ç–æ–∫ –Ω–∞—Å—Ç–æ—è—â–∏—Ö —Ü–µ–Ω–∏—Ç–µ–ª–µ–π! üëëü•É",
                    "–ö—Ä–µ–ø–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–≥—Ä–µ–µ—Ç –∏–∑–Ω—É—Ç—Ä–∏! üî•ü•É",
                    "–ê–ª–∫–æ–≥–æ–ª—å - –∏—Å–∫—É—Å—Å—Ç–≤–æ –≤ –∂–∏–¥–∫–æ–º –≤–∏–¥–µ! üé®ü•É",
                    "–î–ª—è —Å–º–µ–ª—ã—Ö –∏ —Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã—Ö! ü•∑ü•É",
                    "–≠—Ç–æ—Ç –≤–∏—Å–∫–∏ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –≤—ã–¥–µ—Ä–∂–∞–Ω–Ω—ã–π, —á—Ç–æ —É –Ω–µ–≥–æ —É–∂–µ –µ—Å—Ç—å –∏–ø–æ—Ç–µ–∫–∞ –∏ –¥–≤–∞ —Ä–µ–±—ë–Ω–∫–∞ –≤ –∫–æ–ª–ª–µ–¥–∂–µ. ü•Éüè†",
                    "–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ä–æ–º–∞ –Ω–∞—á–∏–Ω–∞–µ—à—å –ø–æ–Ω–∏–º–∞—Ç—å, –æ —á—ë–º –ø–µ–ª –ø–∏—Ä–∞—Ç –≤ —Ç–æ–π –ø–µ—Å–Ω–µ. –ô–æ-—Ö–æ-—Ö–æ –∏ –±—É—Ç—ã–ª–∫–∞... üè¥‚Äç‚ò†Ô∏èü•É",
                    "–í–æ–¥–∫–∞ –Ω–∞—Å—Ç–æ–ª—å–∫–æ —á–∏—Å—Ç–∞—è, —á—Ç–æ —á–µ—Ä–µ–∑ –Ω–µ—ë –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–≤–æ–∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏. ü•Éüîç",
                    "–î–∂–∏–Ω, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–∞–∂–µ –∞–Ω–≥–ª–∏–π—Å–∫–∞—è –∫–æ—Ä–æ–ª–µ–≤–∞ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å '—á—ë—Ä—Ç –ø–æ–±–µ—Ä–∏'! ü•Éüëë",
                    "–¢–µ–∫–∏–ª–∞, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–æ—Å—ã–ø–∞–µ—à—å—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ —Å –∫–∞–∫—Ç—É—Å–æ–º, –Ω–æ –∏ —Å –º–µ–∫—Å–∏–∫–∞–Ω—Å–∫–∏–º –ø–∞—Å–ø–æ—Ä—Ç–æ–º! üåµü•É"
                ])
            elif any(word in post_lower for word in ['–º—É–∑—ã–∫', '–¥–∏–¥–∂–µ–π', '–∫–æ–Ω—Ü–µ—Ä—Ç', '—Ñ–µ—Å—Ç–∏–≤–∞–ª', '—Ç–∞–Ω—Ü', 'live']):
                response = random.choice([
                    "–ú—É–∑—ã–∫–∞ - –¥—É—à–∞ –ª—é–±–æ–π –≤–µ—á–µ—Ä–∏–Ω–∫–∏! üéµüíÉ",
                    "–î–∏–¥–∂–µ–π –ø—Ä–æ—Å—Ç–æ –æ–≥–æ–Ω—å! üî•üéß",
                    "–§–µ—Å—Ç–∏–≤–∞–ª—å –º–µ—á—Ç—ã! –ñ–¥—É –Ω–µ –¥–æ–∂–¥—É—Å—å! ü§©üé™",
                    "–¢–∞–Ω—Ü—ã –¥–æ —É–ø–∞–¥—É! üíÉüï∫",
                    "–ú—É–∑—ã–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –±—å–µ—Ç –ø—Ä—è–º–æ –≤ —Å–µ—Ä–¥—Ü–µ! üíòüéµ",
                    "–ö–æ–Ω—Ü–µ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–æ–º–Ω–∏—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞! üåüüé§",
                    "–ó–≤—É—á–∏—Ç –ª—É—á—à–µ, —á–µ–º –≤ –º–µ—á—Ç–∞—Ö! üé∂‚ú®",
                    "–ë–∞—Å-–±–æ—á–∫–∞ —Ç–∞–∫–∞—è –º–æ—â–Ω–∞—è, —á—Ç–æ —É —Å–æ—Å–µ–¥–µ–π –ø–æ—Å—É–¥–∞ —Å–∞–º–∞ —Ç–∞–Ω—Ü—É–µ—Ç! ü•ÅüíÉ",
                    "–î–∏–¥–∂–µ–π —Å–≤–æ–¥–∏—Ç —Ç–∞–∫, —á—Ç–æ –¥–∞–∂–µ –ø—å—è–Ω—ã–π –¥—è–¥—è –í–∞—Å—è —É —Ç—É—Ä–Ω–∏–∫–µ—Ç–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ –∂–∞–Ω—Ä–∞—Ö! üéßü§ì",
                    "–§–µ—Å—Ç–∏–≤–∞–ª—å, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –¥–æ–∂–¥—å - —ç—Ç–æ –Ω–µ –ø–æ–≥–æ–¥–∞, –∞ –ø–µ—Ä–∫—É—Å—Å–∏–æ–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç! üåßÔ∏èüéµ",
                    "–ú—É–∑—ã–∫–∞ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –≥—Ä–æ–º–∫–∞—è, —á—Ç–æ Shazam —Å–¥–∞–ª—Å—è –∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞–ª '–¥–∞, —ç—Ç–æ –æ–≥–æ–Ω—å'! üî•üì±",
                    "–¢–∞–Ω—Ü—ã —Ç–∞–∫–∏–µ –∑–∞–∂–∏–≥–∞—Ç–µ–ª—å–Ω—ã–µ, —á—Ç–æ –ø–æ–∂–∞—Ä–Ω–∞—è —Å–ª—É–∂–±–∞ —É–∂–µ –Ω–∞–≥–æ—Ç–æ–≤–µ! üíÉüöí"
                ])
            elif any(word in post_lower for word in ['–µ–¥–∞', '–±—É—Ä–≥–µ—Ä', '–∑–∞–∫—É—Å–∫', '–≥–∞—Å—Ç—Ä–æ–Ω–æ–º', '–∫—É—Ö–Ω', '—Ä–µ—Ü–µ–ø—Ç']):
                response = random.choice([
                    "–ï–¥–∞, –æ—Ç –∫–æ—Ç–æ—Ä–æ–π —Å–ª—é–Ω–∫–∏ —Ç–µ–∫—É—Ç! ü§§üçî",
                    "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –æ—Ä–≥–∞–∑–º! üçΩÔ∏èüòç",
                    "–ë—É—Ä–≥–µ—Ä - –∫–∞–∫ –æ–±—ä—è—Ç–∏–µ –¥–ª—è –∂–µ–ª—É–¥–∫–∞! ü§óüçî",
                    "–ó–∞–∫—É—Å–∫–∞, —Ä–∞–¥–∏ –∫–æ—Ç–æ—Ä–æ–π —Å—Ç–æ–∏—Ç –ø–∏—Ç—å! üçªü•®",
                    "–í–∫—É—Å–Ω–æ –¥–æ —Å–ª–µ–∑! üò≠üçï",
                    "–ï–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –≥—Ä–µ–µ—Ç –¥—É—à—É! üî•üç≤",
                    "–ù–∞—Å—Ç–æ—è—â–µ–µ –∫—É–ª–∏–Ω–∞—Ä–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ! üë®üç≥üé®",
                    "–ë—É—Ä–≥–µ—Ä –Ω–∞—Å—Ç–æ–ª—å–∫–æ —Å–æ—á–Ω—ã–π, —á—Ç–æ –¥–ª—è –µ–≥–æ –ø–æ–µ–¥–∞–Ω–∏—è –Ω—É–∂–Ω–æ –ø–æ–¥–ø–∏—Å—ã—Ç—å –¥–æ–≥–æ–≤–æ—Ä —Å –ø—Ä–∞—á–µ—á–Ω–æ–π! üçîüöø",
                    "–ó–∞–∫—É—Å–∫–∞, —Ä–∞–¥–∏ –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–∏—Ç—å –∏–∑–º–µ–Ω—É. –ù—É, –ø–æ—á—Ç–∏. ü•®üò†",
                    "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —à–µ–¥–µ–≤—Ä, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–æ—á–µ—Ç—Å—è –∞–ø–ª–æ–¥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–∞—Ä—É —Å—Ç–æ—è. –ò –ø–ª–∞–∫–∞—Ç—å. üçΩÔ∏èüëèüò≠",
                    "–ï–¥–∞, –æ—Ç –∫–æ—Ç–æ—Ä–æ–π –∏–Ω—Å—Ç–∞–≥—Ä–∞–º –ø–ª–∞—á–µ—Ç –æ—Ç —Å—á–∞—Å—Ç—å—è, –∞ –¥–∏–µ—Ç–æ–ª–æ–≥ - –æ—Ç –≥–æ—Ä—è. üì∏üçîüò≠",
                    "–≠—Ç–æ –Ω–µ –∑–∞–∫—É—Å–∫–∞, —ç—Ç–æ —Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω—ã–π –∫—Ä—É–≥ –¥–ª—è —Ç–≤–æ–µ–≥–æ –ø–æ—Ö–º–µ–ª—å—è! ü•®"
                ])
            elif any(word in post_lower for word in ['–≤–µ—á–µ—Ä–∏–Ω–∫', '—Ç—É—Å–æ–≤–∫', 'party', '–Ω–æ—á—å', '–∫–ª—É–±']):
                response = random.choice([
                    "–í–µ—á–µ—Ä–∏–Ω–∫–∞ –º–µ—á—Ç—ã! üéâüåü",
                    "–ù–æ—á—å, –∫–æ—Ç–æ—Ä—É—é –Ω–µ –∑–∞–±—É–¥–µ—à—å! üåô‚ú®",
                    "–¢—É—Å–æ–≤–∫–∞ –æ–≥–æ–Ω—å! –ñ–∞–ª—å, —á—Ç–æ —è –Ω–µ —Å –≤–∞–º–∏! üî•üò¢",
                    "Party like there's no tomorrow! üíÉüï∫",
                    "–ö–ª—É–±, –≥–¥–µ —Ä–æ–∂–¥–∞—é—Ç—Å—è –ª–µ–≥–µ–Ω–¥—ã! üëëüé™",
                    "–í–µ—á–µ—Ä–∏–Ω–∫–∞, –æ—Ç –∫–æ—Ç–æ—Ä–æ–π –±–æ–ª–∏—Ç –≤—Å–µ, –∫—Ä–æ–º–µ –¥—É—à–∏! üí™üòÇ",
                    "–ù–æ—á—å –±–µ–∑—É–º–∏—è –∏ –≤–µ—Å–µ–ª—å—è! üåÉüéä",
                    "–í–µ—á–µ—Ä–∏–Ω–∫–∞ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –∫—Ä—É—Ç–∞—è, —á—Ç–æ –¥–∞–∂–µ –æ—Ö—Ä–∞–Ω–Ω–∏–∫ —É –≤—Ö–æ–¥–∞ —Ç–∞–Ω—Ü—É–µ—Ç –ª—É—á—à–µ –º–µ–Ω—è! üíÉüï∫",
                    "–¢—É—Å–æ–≤–∫–∞, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–π '–ø—Ä–∏–≤–µ—Ç, —è —Ç–≤–æ–π –¥–∏–≤–∞–Ω' –∑–≤—É—á–∏—Ç –∫–∞–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Ä—É–∫–∏ –∏ —Å–µ—Ä–¥—Ü–∞! üõãÔ∏èüíç",
                    "–ù–æ—á—å, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å —Ç–∞–º, –≥–¥–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ª–µ–≥–µ–Ω–¥–∞. –ò –ø–æ–∏—Å–∫ –∫–ª—é—á–µ–π. üåÉüóùÔ∏è",
                    "Party level: '–∑–∞–≤—Ç—Ä–∞ —É—Ç—Ä–æ–º –±—É–¥—É –∂–∞–ª–µ—Ç—å, –Ω–æ —Å–µ–π—á–∞—Å - –ù–ï–¢!' üí™üòÇ",
                    "–ö–ª—É–±, –≤ –∫–æ—Ç–æ—Ä–æ–º –¥–∞–∂–µ –ª–µ–¥ –≤ —Å—Ç–∞–∫–∞–Ω–µ —Ç–∞–Ω—Ü—É–µ—Ç –ª—É—á—à–µ –º–µ–Ω—è. –ù–æ —è —Å—Ç–∞—Ä–∞—é—Å—å! üßäüíÉ"
                ])
            elif any(word in post_lower for word in ['—Ä–æ–∑—ã–≥—Ä—ã—à', '–∫–æ–Ω–∫—É—Ä—Å', '–ø–æ–¥–∞—Ä–æ–∫', '–ø—Ä–∏–∑', '–≤—ã–∏–≥—Ä']):
                response = random.choice([
                    "–†–æ–∑—ã–≥—Ä—ã—à - –º–µ—á—Ç–∞ —Å–±—ã–≤–∞–µ—Ç—Å—è! üéÅ‚ú®",
                    "–•–æ—á—É –≤—ã–∏–≥—Ä–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–∏–∑! üôèüéØ",
                    "–ö–æ–Ω–∫—É—Ä—Å, —Ä–∞–¥–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —Å—Ç–æ–∏—Ç –∂–∏—Ç—å! üèÜ‚ù§Ô∏è",
                    "–ü–æ–¥–∞—Ä–æ–∫ –º–µ—á—Ç—ã! –•–æ—á—É —Ç–∞–∫–æ–π –∂–µ! ü§©üéÅ",
                    "–£–¥–∞—á–∞, —É–ª—ã–±–Ω–∏—Å—å –º–Ω–µ! üçÄüòä",
                    "–†–æ–∑—ã–≥—Ä—ã—à, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–º–µ–Ω–∏—Ç –∂–∏–∑–Ω—å! üåüüéÅ",
                    "–ü—Ä–∏–∑, —Ä–∞–¥–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —è –≥–æ—Ç–æ–≤ –Ω–∞ –≤—Å–µ! üí™üéØ",
                    "–•–æ—á—É —ç—Ç–æ—Ç –ø—Ä–∏–∑ —Ç–∞–∫ —Å–∏–ª—å–Ω–æ, —á—Ç–æ –≥–æ—Ç–æ–≤ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É –¥–∞–∂–µ –æ—Ç —Ç—ë—Ç–∏ –ì–ª–∞—à–∏! üìßüéÅ",
                    "–†–æ–∑—ã–≥—Ä—ã—à, —Ä–∞–¥–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —è —Å–æ–∑–¥–∞–ª 15 —Ñ–µ–π–∫–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤. –®—É—á—É. –ò–ª–∏ –Ω–µ—Ç? üëÄüéØ",
                    "–≠—Ç–æ—Ç –ø–æ–¥–∞—Ä–æ–∫ –Ω—É–∂–µ–Ω –º–Ω–µ –±–æ–ª—å—à–µ, —á–µ–º —Ä—ã–±–∞–∫—É - –Ω–æ–≤–∞—è —É–¥–æ—á–∫–∞. –õ–∞–¥–Ω–æ, –º–æ–∂–µ—Ç –Ω–µ —Å–æ–≤—Å–µ–º. üé£üéÅ",
                    "–ï—Å–ª–∏ —è –≤—ã–∏–≥—Ä–∞—é, –æ–±–µ—â–∞—é –¥–µ–ª–∏—Ç—å—Å—è... —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ —Ç–æ–≥–æ, –∫–∞–∫ –∏–º –ø–æ–ª—å–∑—É—é—Å—å! ü§≥üéÅ",
                    "–£–¥–∞—á–∞, –±—É–¥—å –∫–æ –º–Ω–µ –±–ª–∞–≥–æ—Å–∫–ª–æ–Ω–Ω–∞, –∫–∞–∫ –∫–æ—Ç –∫ —Ç–æ–º—É, —É –∫–æ–≥–æ –≤–∫—É—Å–Ω—è—à–∫–∞! üçÄüêà"
                ])
            elif any(word in post_lower for word in ['–¥–µ–≥—É—Å—Ç–∞—Ü', '–ø—Ä–æ–±', '–≤–∫—É—Å', '–∞—Ä–æ–º–∞—Ç', '–±—É–∫–µ—Ç']):
                response = random.choice([
                    "–î–µ–≥—É—Å—Ç–∞—Ü–∏—è - –ø—Ä–∞–∑–¥–Ω–∏–∫ –¥–ª—è —Ä–µ—Ü–µ–ø—Ç–æ—Ä–æ–≤! üëÖüéâ",
                    "–í–∫—É—Å, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –º—É—Ä–∞—à–∫–∏! ü•∂üëå",
                    "–ê—Ä–æ–º–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–≤–æ–¥–∏—Ç —Å —É–º–∞! ü§ØüëÉ",
                    "–ë—É–∫–µ—Ç, –¥–æ—Å—Ç–æ–π–Ω—ã–π –∫–æ—Ä–æ–ª–µ–π! üëëüç∑",
                    "–î–µ–≥—É—Å—Ç–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç—ã! üåÖüç∫",
                    "–í–∫—É—Å–æ–≤–æ–π –≤–∑—Ä—ã–≤! üí•üòã",
                    "–ù–∞—Å—Ç–æ—è—â–µ–µ –Ω–∞—Å–ª–∞–∂–¥–µ–Ω–∏–µ –¥–ª—è –≥—É—Ä–º–∞–Ω–∞! üòåüçΩÔ∏è",
                    "–î–µ–≥—É—Å—Ç–∞—Ü–∏—è, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–π –º–æ–π —è–∑—ã–∫ –ø–æ–ª—É—á–∏–ª –ù–æ–±–µ–ª–µ–≤—Å–∫—É—é –ø—Ä–µ–º–∏—é –ø–æ –≤–∫—É—Å–æ–≤–µ–¥–µ–Ω–∏—é! üëÖüèÜ",
                    "–ê—Ä–æ–º–∞—Ç —Ç–∞–∫–æ–π —Å–ª–æ–∂–Ω—ã–π, —á—Ç–æ –¥–ª—è –µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –Ω–µ —Ö–≤–∞—Ç–∏—Ç –æ–¥–Ω–æ–≥–æ –Ω–æ—Å–∞! üëÉüëÉ",
                    "–ü–æ—Å–ª–µ —ç—Ç–æ–π –ø—Ä–æ–±—ã –ø–æ–Ω–∏–º–∞–µ—à—å, —á—Ç–æ –¥–æ —ç—Ç–æ–≥–æ —Ç—ã –Ω–µ –∂–∏–ª, –∞ –ø—Ä–æ—Å—Ç–æ –∂–µ–≤–∞–ª! üòÆüç∑",
                    "–í–∫—É—Å–æ–≤—ã–µ —Ä–µ—Ü–µ–ø—Ç–æ—Ä—ã —Ç–∞–Ω—Ü—É—é—Ç –ª–∞–º–±–∞–¥—É, –∞ –Ω–æ—Å - —Ç–∞–Ω–≥–æ! üëÉüíÉüï∫",
                    "–ë—É–∫–µ—Ç –Ω–∞—Å—Ç–æ–ª—å–∫–æ –∏–∑—ã—Å–∫–∞–Ω–Ω—ã–π, —á—Ç–æ —Ö–æ—á–µ—Ç—Å—è –∏–∑–≤–∏–Ω–∏—Ç—å—Å—è –ø–µ—Ä–µ–¥ —Å–≤–æ–∏–º –ø—Ä–æ—à–ª—ã–º –∞–ª–∫–æ–≥–æ–ª—å–Ω—ã–º –æ–ø—ã—Ç–æ–º. üç∑üôè"
                ])
            else:
                response = random.choice([
                    "–û—Ç–ª–∏—á–Ω—ã–π –ø–æ—Å—Ç! –ñ–¥—É –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è! üî•üìù",
                    "–ö–æ–Ω—Ç–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ä—è–∂–∞–µ—Ç —ç–Ω–µ—Ä–≥–∏–µ–π! ‚ö°üòÑ",
                    "–ü–æ—Å–ª–µ —Ç–∞–∫–æ–≥–æ —Ö–æ—á–µ—Ç—Å—è —Ç–≤–æ—Ä–∏—Ç—å! üé®‚ú®",
                    "–≠—Ç–æ—Ç –ø–æ—Å—Ç - pure gold! üèÜüëè",
                    "–í—ã–¥–∞–µ—Ç–µ –∫–∞–∫ –≤—Å–µ–≥–¥–∞ –Ω–∞ –≤—ã—Å–æ—Ç–µ! üöÄüí´",
                    "–ö–æ–Ω—Ç–µ–Ω—Ç —É—Ä–æ–≤–Ω—è –±–æ–≥–æ–≤! üëëüåü",
                    "–ü–æ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –¥–µ–Ω—å –ª—É—á—à–µ! ‚òÄÔ∏è‚ù§Ô∏è",
                    "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Ä–∞–¥–∏ –∫–æ—Ç–æ—Ä–æ–π —Å—Ç–æ–∏—Ç –∂–∏—Ç—å! üí™üìö",
                    "–ë–æ–º–±–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç! üí£üî•",
                    "–ù–∞—Å—Ç–æ—è—â–µ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ –ø–æ—Å—Ç–∏–Ω–≥–∞! üé≠üì±",
                    "–≠—Ç–æ—Ç –ø–æ—Å—Ç –Ω–∞—Å—Ç–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à, —á—Ç–æ —è –ø—Ä–æ—Å—Ç–∏–ª –µ–º—É –¥–∞–∂–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–ª–∫–æ–≥–æ–ª—è –≤ –∫–∞–¥—Ä–µ! üìù‚ù§Ô∏è",
                    "–ö–æ–Ω—Ç–µ–Ω—Ç, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ —É –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ª–µ–Ω—Ç–∞ –ø—Ä–æ—Å–∏—Ç –¥–æ–±–∞–≤–∫–∏! ü§ñüçΩÔ∏è",
                    "–ü–æ—Å–ª–µ —Ç–∞–∫–æ–≥–æ –ø–æ—Å—Ç–∞ —Ö–æ—á–µ—Ç—Å—è —Ç–≤–æ—Ä–∏—Ç—å, –ª—é–±–∏—Ç—å –∏ –∑–∞–∫–∞–∑—ã–≤–∞—Ç—å –ø–∏—Ü—Ü—É. –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ! üé®‚ù§Ô∏èüçï",
                    "–≠—Ç–æ –Ω–µ –ø–æ—Å—Ç, —ç—Ç–æ –¥—É—Ö–æ–≤–Ω–∞—è —Å–∫—Ä–µ–ø–∫–∞ –¥–ª—è –º–æ–µ–π –ª–µ–Ω—Ç—ã! üìé‚ú®",
                    "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≥—Ä–µ–µ—Ç –¥—É—à—É –ª—É—á—à–µ, —á–µ–º –≥–ª–∏–Ω—Ç–≤–µ–π–Ω –≤ –¥–µ–∫–∞–±—Ä–µ! üî•üìö",
                    "–ë–æ–º–±–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç! –î–∞–∂–µ —Å–ø–∞–º-–±–æ—Ç—ã —Å—Ç–∞–≤—è—Ç –ª–∞–π–∫–∏! üí£ü§ñ",
                    "–ü–æ—Å—Ç —É—Ä–æ–≤–Ω—è '—è —ç—Ç–æ –ø–æ–∫–∞–∂—É —Å–≤–æ–∏–º –±—É–¥—É—â–∏–º –¥–µ—Ç—è–º –∫–∞–∫ –ø—Ä–∏–º–µ—Ä –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞'! üë∂üì±",
                    "–≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç–æ–∏—Ç —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∑–∞ –Ω–µ–≥–æ –ø–ª–∞—Ç–∏—Ç—å. –ù–æ —è, –∫–æ–Ω–µ—á–Ω–æ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ –ø–æ—Ç—Ä–µ–±–ª—é. üòèüìù"
                ])

            responses.append({"post": post, "response": response})
            if (i + 1) % 20 == 0:
                print(f"üéØ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ {i + 1} –æ—Ç–≤–µ—Ç–æ–≤...")

        print(f"‚úÖ –í—Å–µ–≥–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ {len(responses)} –æ—Ç–≤–µ—Ç–æ–≤")
        return responses

class SimpleModelTrainer:
    """–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ç—Ä–µ–Ω–µ—Ä –º–æ–¥–µ–ª–∏"""
    def __init__(self, base_model="sberbank-ai/rugpt3small_based_on_gpt2"):
        self.tokenizer = GPT2Tokenizer.from_pretrained(base_model)
        self.model = GPT2LMHeadModel.from_pretrained(base_model)

        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º pad_token
        if self.tokenizer.pad_token is None:
            self.tokenizer.pad_token = self.tokenizer.eos_token

    def prepare_training_data(self, posts_responses):
        """–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è"""
        training_texts = []

        for item in posts_responses:
            # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
            text = f"POST: {item['post']} RESPONSE: {item['response']}{self.tokenizer.eos_token}"
            training_texts.append(text)

        return training_texts

    def train(self, training_texts, output_dir="./my_trained_model"):
        """–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏"""
        print(f"üìö –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ {len(training_texts)} –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è...")

        # –°–æ–∑–¥–∞–µ–º –¥–∞—Ç–∞—Å–µ—Ç
        dataset = Dataset.from_dict({"text": training_texts})

        # –¢–æ–∫–µ–Ω–∏–∑–∏—Ä—É–µ–º
        def tokenize_function(examples):
            return self.tokenizer(
                examples["text"],
                truncation=True,
                padding=False,
                max_length=128,
                return_tensors=None
            )

        tokenized_dataset = dataset.map(tokenize_function, batched=True)

        # Data collator
        data_collator = DataCollatorForLanguageModeling(
            tokenizer=self.tokenizer,
            mlm=False,
        )

        # –£–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –æ–±—É—á–µ–Ω–∏—è
        training_args = TrainingArguments(
            output_dir=output_dir,
            overwrite_output_dir=True,
            num_train_epochs=3,
            per_device_train_batch_size=2,
            save_steps=10000,
            save_total_limit=2,
            logging_steps=50,
            learning_rate=5e-5,
            weight_decay=0.01,
            warmup_steps=100,
        )

        trainer = Trainer(
            model=self.model,
            args=training_args,
            train_dataset=tokenized_dataset,
            data_collator=data_collator,
            tokenizer=self.tokenizer,
        )

        print("üöÄ –ù–∞—á–∏–Ω–∞—é –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏...")
        trainer.train()

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–æ–¥–µ–ª—å
        trainer.save_model()
        self.tokenizer.save_pretrained(output_dir)
        print(f"‚úÖ –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ {output_dir}")

class TrainedBot:
    """–ë–æ—Ç —Å –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é"""
    def __init__(self, model_path="./my_trained_model"):
        try:
            self.tokenizer = GPT2Tokenizer.from_pretrained(model_path)
            self.model = GPT2LMHeadModel.from_pretrained(model_path)
            self.model.eval()
            self.model_loaded = True
            print("‚úÖ –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞!")
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏: {e}")
            self.model_loaded = False
            # Fallback –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ —à–∞–±–ª–æ–Ω—ã
            self.fallback_responses = [
                "–ö—Ä—É—Ç–æ–π –ø–æ—Å—Ç! üî•", "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! üëç", "–û—Ç–ª–∏—á–Ω–æ! üöÄ",
                "–ñ–¥—É –µ—â–µ! üí´", "–°—É–ø–µ—Ä! üòÑ"
            ]

    def generate_response(self, post_text):
        if not self.model_loaded:
            return random.choice(self.fallback_responses)

        try:
            # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–º–ø—Ç –≤ —Ç–æ–º –∂–µ —Ñ–æ—Ä–º–∞—Ç–µ, —á—Ç–æ –∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏
            prompt = f"POST: {post_text} RESPONSE:"

            inputs = self.tokenizer.encode(prompt, return_tensors="pt")

            with torch.no_grad():
                outputs = self.model.generate(
                    inputs,
                    max_length=inputs.shape[1] + 30,
                    max_new_tokens=25,
                    do_sample=True,
                    temperature=0.8,
                    top_p=0.9,
                    repetition_penalty=1.1,
                    pad_token_id=self.tokenizer.eos_token_id,
                    num_return_sequences=1
                )

            response = self.tokenizer.decode(outputs[0], skip_special_tokens=True)
            # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç
            if "RESPONSE:" in response:
                return response.split("RESPONSE:")[-1].strip()
            else:
                return response.replace(prompt, "").strip()

        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: {e}")
            return random.choice(self.fallback_responses)

async def create_client(session_name):
    """–°–æ–∑–¥–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç Telegram"""
    API_ID = 24902189
    API_HASH = 'bc628acc3efe8022ca2a906228a810b3'
    PHONE = '+79045995788'

    client = TelegramClient(
        session=session_name,
        api_id=API_ID,
        api_hash=API_HASH,
        device_model='PC',
        system_version=platform.system(),
        app_version='4.0.0'
    )

    await client.start(phone=PHONE)
    print("‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!")
    return client

# –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∞ –∏ –æ–±—É—á–µ–Ω–∏—è
async def collect_and_train():
    """–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏"""
    CHANNEL = '@stepiveter'

    # 1. –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç –∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ–º—Å—è
    print("üìä –≠—Ç–∞–ø 1: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞...")
    client = await create_client('data_collector_session')

    # 2. –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    print("üìä –≠—Ç–∞–ø 2: –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö...")
    collector = DataCollector()
    posts = await collector.collect_posts(client, CHANNEL, limit=10000)

    # 3. –û—Ç–∫–ª—é—á–∞–µ–º –∫–ª–∏–µ–Ω—Ç –ø–æ—Å–ª–µ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
    await client.disconnect()

    # 4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç—ã
    print("üéØ –≠—Ç–∞–ø 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤...")
    response_gen = ResponseGenerator()
    training_data = response_gen.generate_responses(posts)

    # 5. –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
    with open('training_data.json', 'w', encoding='utf-8') as f:
        json.dump(training_data, f, ensure_ascii=False, indent=2)
    print(f"üíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ training_data.json ({len(training_data)} –ø—Ä–∏–º–µ—Ä–æ–≤)")

    # 6. –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å
    print("üöÄ –≠—Ç–∞–ø 4: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏...")
    trainer = SimpleModelTrainer()
    training_texts = trainer.prepare_training_data(training_data)
    trainer.train(training_texts)

    print("üéâ –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –ú–æ–¥–µ–ª—å –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.")

# –ë–æ—Ç —Å –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é
async def run_trained_bot():
    """–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ —Å –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é"""
    CHANNEL = '@tracktap'

    # 1. –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç –∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ–º—Å—è
    print("üöÄ –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è –±–æ—Ç–∞...")
    client = await create_client('bot_session')

    # 2. –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å
    bot = TrainedBot()

    channel = await client.get_entity(CHANNEL)
    print(f"üéØ –ú–æ–Ω–∏—Ç–æ—Ä–∏–º –∫–∞–Ω–∞–ª: {channel.title}")

    @client.on(events.NewMessage(chats=channel))
    async def message_handler(event):
        if event.message.sender_id != (await client.get_me()).id:
            print(f"üì® –ù–æ–≤—ã–π –ø–æ—Å—Ç: {event.message.text[:100]}...")

            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å
            post_text = event.message.text or ""
            comment = bot.generate_response(post_text)
            print(f"ü§ñ –û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏: {comment}")

            await asyncio.sleep(random.randint(5, 20))

            try:
                await client.send_message(
                    entity=channel,
                    message=comment,
                    comment_to=event.message.id
                )
                print("‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω")
            except Exception as e:
                print(f"‚ùå –û—à–∏–±–∫–∞: {e}")

    print("üöÄ –ë–æ—Ç —Å –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é –∑–∞–ø—É—â–µ–Ω!")
    await client.run_until_disconnected()

# –í—ã–±–µ—Ä–∏ —á—Ç–æ –∑–∞–ø—É—Å–∫–∞—Ç—å:
if __name__ == "__main__":
    # –í–∞—Ä–∏–∞–Ω—Ç 1: –°–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å (–∑–∞–ø—É—Å—Ç–∏ –æ–¥–∏–Ω —Ä–∞–∑)
    asyncio.run(collect_and_train())

    # –í–∞—Ä–∏–∞–Ω—Ç 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ —Å —É–∂–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é
    # asyncio.run(run_trained_bot())